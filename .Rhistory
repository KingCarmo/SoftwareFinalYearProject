html_text()
StokeMP6 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[8]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeCP6 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[8]/div/div/div[2]/div/div[8]') %>%
html_text()
StokeGoal6 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal6))
StokeAssist6 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist6))
StokeYC6 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC6))
StokeRC6 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC6))
StokeMP6 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP6))
StokeCP6 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeCP6))
#Danny Batth
StokeGoal7 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[11]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist7 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[11]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC7 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[11]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC7 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[11]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP7 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[11]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeCP7 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[11]/div/div/div[2]/div/div[8]') %>%
html_text()
StokeGoal7 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal7))
StokeAssist7 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist7))
StokeYC7 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC7))
StokeRC7 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC7))
StokeMP7 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP7))
StokeCP7 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeCP7))
#Darren Fletcher
StokeGoal8 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[13]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist8 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[13]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC8 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[13]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC8 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[13]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP8 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[13]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeCP8 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[13]/div/div/div[2]/div/div[8]') %>%
html_text()
StokeGoal8 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal8))
StokeAssist8 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist8))
StokeYC8 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC8))
StokeRC8 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC8))
StokeMP8 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP8))
StokeCP8 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeCP8))
#Jack Butland
StokeGoal9 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[14]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist9 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[14]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC9 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[14]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC9 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[14]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP9 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[14]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeGoal9 <- StokeGoal1[ StokeGoal1 == "foo" ] <- 0
StokeAssist9 <- StokeAssist1[ StokeAssist1 == "foo" ] <- 0
StokeYC9 <- StokeYC9[ StokeYC9 == "foo" ] <- 0
StokeRC9 <- StokeRC9[ StokeRC9 == "foo" ] <- 0
StokeMP9 <- StokeMP9[ StokeMP9 == "foo" ] <- 44
#Jakob Haugaard
StokeGoal10 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[16]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist10 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[16]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC10 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[16]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC10 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[16]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP10 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[16]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeGoal10 <- StokeGoal10[ StokeGoal10 == "foo" ] <- 0
StokeAssist10 <- StokeAssist10[ StokeAssist10 == "foo" ] <- 0
StokeYC10 <- StokeYC10[ StokeYC10 == "foo" ] <- 0
StokeRC10 <- StokeRC10[ StokeRC10 == "foo" ] <- 0
StokeMP10 <- StokeMP10[ StokeMP10 == "foo" ] <- 5
#James McClean
StokeGoal11 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[17]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist11 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[17]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC11 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[17]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC11 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[17]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP11 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[17]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeCP11 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[17]/div/div/div[2]/div/div[8]') %>%
html_text()
StokeGoal11 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal11))
StokeAssist11 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist11))
StokeYC11 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC11))
StokeRC11 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC11))
StokeMP11 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP11))
StokeCP11 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeCP11))
#Joe Allen
StokeGoal12 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[19]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist12 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[19]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC12 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[19]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC12 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[19]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP12 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[19]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeCP12 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[19]/div/div/div[2]/div/div[8]') %>%
html_text()
StokeGoal12 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal12))
StokeAssist12 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist12))
StokeYC12 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC12))
StokeRC12 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC12))
StokeMP12 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP12))
StokeCP12 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeCP12))
#Josh Tymon
StokeGoal13 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[20]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist13 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[20]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC13 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[20]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC13 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[20]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP13 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[20]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeGoal13 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal13))
StokeAssist13 <- StokeAssist11[ StokeAssist11 == "foo" ] <- 0
StokeYC13 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC13))
StokeRC13 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC13))
StokeMP13 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP13))
#Mame Biram Diouf
StokeGoal14 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[23]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist14 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[23]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC14 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[23]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC14 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[23]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP14 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[23]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeGoal14 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal14))
StokeAssist14 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist14))
StokeYC14 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC14))
StokeRC14 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC14))
StokeMP14 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP14))
#Ryan Shawcross
StokeGoal15 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[29]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist15 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[29]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC15 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[29]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC15 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[29]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP15 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[29]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeGoal15 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal15))
StokeAssist15 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist15))
StokeYC15 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC15))
StokeRC15 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC15))
StokeMP15 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP15))
#Thomas Ince
StokeGoal16 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[40]/div/div/div[2]/div/div[1]') %>%
html_text()
StokeAssist16 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[40]/div/div/div[2]/div/div[2]') %>%
html_text()
StokeYC16 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[40]/div/div/div[2]/div/div[4]') %>%
html_text()
StokeRC16 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[40]/div/div/div[2]/div/div[5]') %>%
html_text()
StokeMP16 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[40]/div/div/div[2]/div/div[6]') %>%
html_text()
StokeCP16 <- fctables_wbpg %>%
html_nodes(".player_box") %>%
html_nodes(xpath = '//*[@id="team-players"]/div/div[2]/div[40]/div/div/div[2]/div/div[8]') %>%
html_text()
StokeGoal16 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeGoal16))
StokeAssist16 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeAssist16))
StokeYC16 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeYC16))
StokeRC16 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeRC16))
StokeMP16 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeMP16))
StokeCP16 <-as.integer(gsub("([0-9]+).*$", "\\1", StokeCP16))
########## Remove Certain Rows From Stoke Dataset #############
Stoke <- data.frame(PlayerNames)
View(Stoke)
Stoke <- Stoke[-c(7,15, 17:19, 21:26), ]
Stoke <- as.character(Stoke)
Stoke <- data.frame(Stoke)
############ Creating Datasets for All Data ###############
StokeAssists <- c(StokeAssist1, StokeAssist2,  StokeAssist3, StokeAssist4, StokeAssist5, StokeAssist6, StokeAssist7, StokeAssist8, StokeAssist9, StokeAssist10, StokeAssist11, StokeAssist12, StokeAssist13, StokeAssist14, StokeAssist15, StokeAssist16)
Stoke$Assists <- data.frame(StokeAssists)
StokeGoals <- c(StokeGoal1, StokeGoal2, StokeGoal3, StokeGoal4, StokeGoal5, StokeGoal6, StokeGoal7, StokeGoal8, StokeGoal9, StokeGoal10, StokeGoal11, StokeGoal12, StokeGoal13, StokeGoal14, StokeGoal15, StokeGoal16)
Stoke$Goals <- data.frame(StokeGoals)
StokeYC <- c(StokeYC1, StokeYC2, StokeYC3, StokeYC4, StokeYC5, StokeYC6, StokeYC7, StokeYC8, StokeYC9, StokeYC10, StokeYC11, StokeYC12, StokeYC13, StokeYC14, StokeYC15, StokeYC16)
Stoke$YellowCards <- data.frame(StokeYC)
StokeRC <- c(StokeRC1, StokeRC2, StokeRC3, StokeRC4, StokeRC5, StokeRC6, StokeRC7, StokeRC8, StokeRC9, StokeRC10, StokeRC11, StokeRC12, StokeRC13, StokeRC14, StokeRC15, StokeRC16)
Stoke$RedCards <- data.frame(StokeRC)
StokeMP <- c(StokeMP1, StokeMP2, StokeMP3, StokeMP4, StokeMP5, StokeMP6, StokeMP7, StokeMP8, StokeMP9, StokeMP10, StokeMP11, StokeMP12, StokeMP13, StokeMP14, StokeMP15, StokeMP16)
Stoke$PlayedGames <- data.frame(StokeMP)
######################### Prediction Values - Stoke #######################
library(rvest)
library(stringr)
library("tm", lib.loc="~/R/win-library/3.5")
Stoketransfermarkt_wbpg <- read_html("StokeTM.html")
#players names
PlayerName <- Stoketransfermarkt_wbpg %>%
html_nodes(".responsive-table") %>%
html_nodes(".posrela") %>%
html_nodes(".hide-for-small") %>%
html_nodes(".spielprofil_tooltip") %>%
html_text()
#Players Current Value
PlayerCurrentValue <- Stoketransfermarkt_wbpg %>%
html_nodes(".responsive-table") %>%
html_nodes("td.hauptlink:nth-child(10)") %>%
html_text()
#Previous Current Value
StokePreviousValueTM <- Stoketransfermarkt_wbpg %>%
html_nodes(".responsive-table") %>%
html_nodes("td.rechts") %>%
html_nodes(".icons_sprite")
#Age
StokeAge <- Stoketransfermarkt_wbpg %>%
html_nodes(".responsive-table") %>%
html_nodes("td.zentriert:nth-child(3)") %>%
html_text()
#Nationality
PlayerCountry <- Stoketransfermarkt_wbpg %>%
html_nodes(".ausfall-1-table , #yw1 .flaggenrahmen:nth-child(1)")
StokeclubCountryTM <- html_attr(PlayerCountry, "alt")
is.na(StokeclubCountryTM)
StokeclubCountryTM <- na.omit(StokeclubCountryTM)
rownames(StokeclubCountryTM)<-NULL
StokePreviousValueTM2 <- html_attr(StokePreviousValueTM, "title")
PreviousValue <- gsub("[^0-9.]","",StokePreviousValueTM2)
CurrentValue <- gsub("[^0-9.]","",PlayerCurrentValue)
#names(mydf) <- gsub("\\.", "", names(mydf))
Value2017 <- c(
"13500000",
"900000",
"675000",
"9000000",
"9900000",
"7200000",
"900000",
"900000",
"2070000",
"450000",
"1350000",
"13500000",
"900000",
"3150000",
"1800000",
"2250000",
"2700000",
"6300000",
"7200000",
"9000000",
"13500000",
"3600000",
"6300000"
)
Value2017 <- as.numeric(Value2017)
Value2016 <- c(
"8100000",
"900000",
"900000",
"9000000",
"8100000",
"7200000",
"900000",
"450000",
"1800000",
"0",
"1350000",
"10800000",
"135000",
"4050000",
"1800000",
"2250000",
"2700000",
"9000000",
"900000",
"8100000",
"13500000",
"3150000",
"7200000"
)
Value2016 <- as.numeric(Value2016)
Value2015 <- c(
"3150000",
"900000",
"675000",
"10350000",
"8100000",
"5850000",
"900000",
"0",
"1800000",
"0",
"450000",
"9000000",
"135000",
"3600000",
"1800000",
"1350000",
"2700000",
"5850000",
"6300000",
"6300000",
"13500000",
"2250000",
"8100000"
)
Value2015 <- as.numeric(Value2015)
Value2019 <- as.double(CurrentValue, digits=2)
Value2019 <- as.data.frame(Value2019)
Value2018 <- as.double(PreviousValue, digits=2)
Value2018 <- as.double(Value2018)
StokeCity <- data.frame(PlayerName, StokeclubCountryTM, StokeAge, Value2017, Value2016, Value2015)
StokeCity <- cbind(StokeCity, Value2019, Value2018)
for (i in 1:nrow(StokeCity)) {
if(StokeCity[i , "Value2019"] < 25)
StokeCity$Value2019[i] <- StokeCity[i , "Value2019"]*1000000
else
StokeCity$Value2019[i] <- StokeCity[i , "Value2019"]*1000
}
for (i in 1:nrow(StokeCity)) {
if(StokeCity[i , "Value2018"] < 25)
StokeCity$Value2018[i] <- StokeCity[i , "Value2018"]*1000000
else
StokeCity$Value2018[i] <- StokeCity[i , "Value2018"]*1000
}
##################### Linear Regression - Stoke ############################
#install.packages("ISLR")
library(ISLR)
StokeCity <- StokeCity
?StokeCity
str(StokeCity)
# check for missing data
sapply(StokeCity, FUN=function(x) {sum(is.na(x))})
# Model Evaluation
# Going with our holdout set
# pick 75% of row indexes (i.e. row numbers)
index <- sample(1:nrow(StokeCity), nrow(StokeCity)*.75, replace=FALSE)
#those chosen, put in the training data frame
training <- StokeCity[index, ]
#those not chosen, put in the testing data frame
testing <- StokeCity[-index, ]
getPerformanceData <- function(model, testingStokeCity)
{
# instrument the predictions
yHat <- predict(model, newdata=testingStokeCity)
# calculate the measures of test performance
MAE <- mean(abs(testing$Value2019 - yHat), na.rm = TRUE)
MSE <- mean((testing$Value2019 - yHat)^2, na.rm = TRUE)
RMSE <- sqrt(MSE)
MAPE <- mean(abs((testing$Value2019 - yHat)/ testing$Value2019), na.rm = TRUE)
return(data.frame(MAE, MSE, RMSE, MAPE))
}
# Multiple Linear Regression
# Y = beta_0 + beta_1 x1 + ... + beta_n xn + err
# balance = beta_0 + beta_1 x limit + beta_2 x income + err
#fit <- lm(testing$`2019 Value` ~ testing$`2018 Value` + testing$`2017 Value` + testing$`2016 Value`, data = Norwich)
#getPerformanceData(fit, testing)
LIRmodel <- lm(Value2019 ~ Value2018 + Value2017 + Value2016 + Value2015 , data=testing)
getPerformanceData(LIRmodel, testing)
summary(LIRmodel)
testing$Predicted<- predict(LIRmodel)
##### Train ####
getPerformanceData <- function(model, trainingStokeCity)
{
# instrument the predictions
yHat <- predict(model, newdata=trainingStokeCity)
# calculate the measures of test performance
MAE <- mean(abs(training$Value2019 - yHat), na.rm = TRUE)
MSE <- mean((training$Value2019 - yHat)^2, na.rm = TRUE)
RMSE <- sqrt(MSE)
MAPE <- mean(abs((training$Value2019 - yHat)/ training$Value2019), na.rm = TRUE)
return(data.frame(MAE, MSE, RMSE, MAPE))
}
LIRmodelTrain <- lm(Value2019 ~ Value2018 + Value2017 + Value2016 + Value2015 , data=training)
getPerformanceData(LIRmodelTrain, training)
summary(LIRmodelTrain)
training$Predicted <- predict(LIRmodelTrain)
#### Combined Predicted Values ####
StokeCity <- merge(testing, training, all = T)
#### Fixing Columns ####
Stoke <- Stoke[order(Stoke$Stoke),]
StokeCity <- StokeCity[order(StokeCity$PlayerName),]
##### Removing Rows ####
StokeCity <- StokeCity[-c(15, 16, 18, 19, 20, 21, 22), ]
write.csv(StokeCity, file ="StokePrice.csv" )
write.csv(Stoke, file ="StokeStats.csv" )
